description: Join Order Benchmark Query 14
suite: job
benchmark: q14
readonly: true
pattern: '^Execute query:.*'
cases:
    a: |
        SELECT MIN(mi_idx.info) AS rating,
               MIN(t.title) AS northern_dark_movie
        FROM info_type AS it1,
             info_type AS it2,
             keyword AS k,
             kind_type AS kt,
             movie_info AS mi,
             movie_info_idx AS mi_idx,
             movie_keyword AS mk,
             title AS t
        WHERE it1.info = "countries"
          AND it2.info = "rating"
          AND k.keyword IN ("murder",
                            "murder-in-title",
                            "blood",
                            "violence")
          AND kt.kind = "movie"
          AND mi.info IN ("Sweden",
                          "Norway",
                          "Germany",
                          "Denmark",
                          "Swedish",
                          "Denish",
                          "Norwegian",
                          "German",
                          "USA",
                          "American")
          AND mi_idx.info < "8.5"
          AND t.production_year > 2010
          AND kt.id = t.kind_id
          AND t.id = mi.movie_id
          AND t.id = mk.movie_id
          AND t.id = mi_idx.movie_id
          AND mk.movie_id = mi.movie_id
          AND mk.movie_id = mi_idx.movie_id
          AND mi.movie_id = mi_idx.movie_id
          AND k.id = mk.keyword_id
          AND it1.id = mi.info_type_id
          AND it2.id = mi_idx.info_type_id;
    b: |
        SELECT MIN(mi_idx.info) AS rating,
               MIN(t.title) AS western_dark_production
        FROM info_type AS it1,
             info_type AS it2,
             keyword AS k,
             kind_type AS kt,
             movie_info AS mi,
             movie_info_idx AS mi_idx,
             movie_keyword AS mk,
             title AS t
        WHERE it1.info = "countries"
          AND it2.info = "rating"
          AND k.keyword IN ("murder",
                            "murder-in-title")
          AND kt.kind = "movie"
          AND mi.info IN ("Sweden",
                          "Norway",
                          "Germany",
                          "Denmark",
                          "Swedish",
                          "Denish",
                          "Norwegian",
                          "German",
                          "USA",
                          "American")
          AND mi_idx.info > "6.0"
          AND t.production_year > 2010
          AND (t.title LIKE "%murder%"
               OR t.title LIKE "%Murder%"
               OR t.title LIKE "%Mord%")
          AND kt.id = t.kind_id
          AND t.id = mi.movie_id
          AND t.id = mk.movie_id
          AND t.id = mi_idx.movie_id
          AND mk.movie_id = mi.movie_id
          AND mk.movie_id = mi_idx.movie_id
          AND mi.movie_id = mi_idx.movie_id
          AND k.id = mk.keyword_id
          AND it1.id = mi.info_type_id
          AND it2.id = mi_idx.info_type_id;
    c: |
        SELECT MIN(mi_idx.info) AS rating,
               MIN(t.title) AS north_european_dark_production
        FROM info_type AS it1,
             info_type AS it2,
             keyword AS k,
             kind_type AS kt,
             movie_info AS mi,
             movie_info_idx AS mi_idx,
             movie_keyword AS mk,
             title AS t
        WHERE it1.info = "countries"
          AND it2.info = "rating"
          AND k.keyword IS NOT NULL
          AND k.keyword IN ("murder",
                            "murder-in-title",
                            "blood",
                            "violence")
          AND kt.kind IN ("movie",
                          "episode")
          AND mi.info IN ("Sweden",
                          "Norway",
                          "Germany",
                          "Denmark",
                          "Swedish",
                          "Danish",
                          "Norwegian",
                          "German",
                          "USA",
                          "American")
          AND mi_idx.info < "8.5"
          AND t.production_year > 2005
          AND kt.id = t.kind_id
          AND t.id = mi.movie_id
          AND t.id = mk.movie_id
          AND t.id = mi_idx.movie_id
          AND mk.movie_id = mi.movie_id
          AND mk.movie_id = mi_idx.movie_id
          AND mi.movie_id = mi_idx.movie_id
          AND k.id = mk.keyword_id
          AND it1.id = mi.info_type_id
          AND it2.id = mi_idx.info_type_id;
