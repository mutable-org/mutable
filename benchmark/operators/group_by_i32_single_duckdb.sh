#!/bin/bash

# Define path to DuckDB CLI
DUCKDB=duckdb_cli

{ ${DUCKDB} | grep 'Run Time' | cut -d ' ' -f 4 | awk '{print $1 * 1000;}'; } << EOF
CREATE TABLE Distinct_i32 ( id INT, n1 INT, n10 INT, n100 INT, n1000 INT, n10000 INT, n100000 INT);
COPY Distinct_i32 FROM 'benchmark/operators/data/Distinct_i32.csv' ( HEADER );
.timer on
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 < -2147483647 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 < -1717986918 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 < -1288490188 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 <  -858993459 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 <  -429496729 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 <           0 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 <   429496729 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 <   858993459 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 <  1288490188 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 <  1717986918 GROUP BY n1000) AS T;
SELECT COUNT(*) FROM (SELECT 1 FROM Distinct_i32 WHERE n1000 <  2147483647 GROUP BY n1000) AS T;
EOF
